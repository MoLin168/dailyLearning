<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Promise</title>
	<script>
		//ES6规定，Promise对象是一个构造函数，用来生成Promise实例;Promise有三种状态：pending,refilled(resolved),rejected
		//举一个简单的栗子
		function timeout(_ms){
			return new Promise((resolve,reject) => {
				setTimeout(resolve,_ms,'done');
				//setTimeout(reject,_ms,'failed');
				});
		};
		timeout(100).then((value) => {
			console.log(value);//done
		});
		// timeout(100).catch((value) => {
		// 	console.log(value);
		// });

		const p1 = new Promise((resolve,reject) => {
			setTimeout(() => reject(new Error('fail')),3000);
		});
		const p2 = new Promise((resolve,reject) => {
			console.log(p1);//Pormise {<pending>}
			setTimeout(() => resolve(p1),1000);
		});
		//p2状态无效，所以无法执行then
		p2.then(result => console.log(result)).catch(error => console.log(error));

		//异步加载图片的fn
		function loadImageAsync(_url){
			return new Promise((resolve,reject) => {
				const image = new Image();

				image.onload = () => {resolve(image)};
				image.onerror = () => {reject(new Error('load image fail' + _url))};

				image.src = _url;
			});
		}

		const url = 'images/fafa.jpg';
		let promise = loadImageAsync(url);
		promise.then(result => console.log(result)).catch(error => console.log(error));

	</script>
</head>
<body>
</body>
</html>